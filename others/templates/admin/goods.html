<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:shiro="http://www.thymeleaf.org/thymeleaf-extras-shiro">
<head>
  <meta name="renderer" content="webkit|ie-comp|ie-stand">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport"
        content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi"/>
  <meta http-equiv="Cache-Control" content="no-siteapp"/>
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
  <link rel="stylesheet" th:href="@{/admin/css/font.css}">
  <link rel="stylesheet" th:href="@{/admin/css/xadmin.css}">
  <script type="text/javascript" src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
  <script type="text/javascript" th:src="@{/admin/lib/layui/layui.js}" charset="utf-8"></script>
  <script type="text/javascript" th:src="@{/admin/js/xadmin.js}"></script>
  <script type="text/javascript" th:src="@{/admin/lib/layui/layui.js}" charset="utf-8"></script>
  <script type="text/javascript" th:src="@{/admin/js/xadmin.js}"></script>
  <style>
    /*.layui-table-cell{*/
    /*    height: 50px;*/
    /*    line-height: 50px;*/
    /*}*/
    .layui-table-cell {
      /*display:table-cell;*/
      /*vertical-align: middle;*/
    }

    .layui-table-cell {
      text-align: center;
      height: auto;
      white-space: normal;
    }


    .layui-table .Img {
      /*max-width: 300px*/
      width: 100%;
      box-sizing: border-box;
      padding: 5px;
    }

    td {
      padding: 0px;
    }

    .x-body {
      padding-top: 10px;
    }

    .x-nav {
      padding: 10px 20px;
    }
  </style>
</head>
<body>
<div class="x-nav">
  <form class="layui-form layui-col-md12 x-so" onsubmit="return false;">

    <input type="text" name="goodsName" id="goodsName" placeholder="请输入商品名" autocomplete="off"
           class="layui-input">
    <button class="layui-btn" lay-submit="" lay-filter="sreach" onclick="show_table()"><i
            class="layui-icon">&#xe615;</i>
    </button>
    <a class="layui-btn layui-btn-small" style="line-height:1.6em;margin-top:3px;float:right"
       href="javascript:location.replace(location.href);" title="刷新">
      <i class="layui-icon" style="line-height:30px">ဂ</i>
    </a>
  </form>

</div>
<div class="x-body">
  <table id="demo" lay-filter="test"></table>

</div>
<script type="text/html" id="barDemo">
  <a class="layui-btn layui-btn-xs" lay-even="detail">查看</a>
  <!--    <a class="layui-btn layui-btn-xs layui-btn-normal" lay-even="detail">编辑</a>-->
  <a class="layui-btn layui-btn-xs  layui-btn-danger" lay-even="detail">下架</a>
</script>

<script>
  // 加载页面时获取
  show_table()

  // 获取表格数据
  function show_table() {
    layui.use('table', function () {
      var table = layui.table;
      var goodsName = $("#goodsName").val()

      var tableIns = table.render({
        elem: "#demo",
        height: 530,
        url: '/admin/getGoodsList', // 数据接口
        where: {goodsName: goodsName}, // 接口的其他参数
        page: true, // 开启分页
        // even: true, // 隔行换色
        toolbar: '#toolbarDemo', //开启头部工具栏，并为其绑定左侧模板
        defaultToolbar: ['filter', 'exports', 'print', { //自定义头部工具栏右侧图标。如无需自定义，去除该参数即可
          title: '提示'
          , layEvent: 'LAYTABLE_TIPS'
          , icon: 'layui-icon-tips'
        }],
        cols: [
          [// 表头
            {field: 'goodsId', title: 'ID', sort: true, fixed: 'left', width: 50},
            {field: 'description', title: '描述', sort: true, fixed: 'center'},
            {field: 'goodsName', title: '商家名称', sort: true, fixed: 'center'},
            {
              field: 'pictureUrl',
              title: '图片',
              // style: 'height:100px;',
              templet: function (d) {
                return '<div onclick="show_img(this)" ><img class="Img" src="' + d.pictureUrl + '" alt=""></a></div>';
              }
              , fixed: 'center'
            },
            {field: 'mallPrice', title: '销售价格', sort: true, fixed: 'center'},
            {field: 'marketPrice', title: '市场价格', sort: true},

            // {
            //     templet: function () {
            //         return "<button class=\"layui-btn layui-btn-xs layui-btn-disabled\">启用</button>";
            //     }, title: '状态'
            // },
            {fixed: 'right', title: '操作', algin: 'center', toolbar: '#barDemo'}

          ]
        ]
        , id: 'testReload'
      })

    })
  }


  //显示大图片
  function show_img(t) {
    var t = $(t).find("img");
    //页面层
    layer.open({
      type: 1,
      offset: ['100px', '400px'],
      // skin: 'layui-layer-rim', //加上边框
      // area: ['80%', '80%'], //宽高
      shadeClose: true, //开启遮罩关闭
      end: function (index, layero) {
        return false;
      },
      content: '<div style="text-align:center"><img src="' + $(t).attr('src') + '" /></div>'
    });
  }
</script>


</body>
</html>